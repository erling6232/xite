<!-- manual page source format generated by RosettaMan v2.5a4, -->
<!-- available via anonymous ftp from ftp.cs.berkeley.edu:/ucb/people/phelps/tcltk/rman.tar.Z -->
<HTML>
<HEAD>
<TITLE>TextMenu</TITLE>
</HEAD>
<BODY>
<A HREF="#toc">Table of Contents</A><P>

<H2><A NAME="sect1" HREF="#toc1">NAME</A></H2>

XfwfTextMenu
<P>

<H2><A NAME="sect2" HREF="#toc2"><B>DESCRIPTION</B></A></H2>

The TextMenu widget implements a simple menu, consisting of
a series of labels. It is called `TextMenu' because it has
no support for anything other than simple strings to be dis­
played.
<P>
The contents of the menu are defined by the <I>menu</I> resource.
The syntax of the description is given further on. When a
menu item is selected, a callback function is called with
the number of the item and the label as <I>call_data</I> argument
(numbering starts at 0).
<P>
When the user moves from one menu item to another, another
callback is called. This callback is called even for inac­
tive (grayed out) items. It can be used, for example, to
display an explanation of the selected item while the mouse
is on it.
<P>
<B>Public</B> <B>variables</B><BR>

_____________________________________________________________________________
<DL>
<DT><B>|</B> <DD>                               <B>XfwfTextMenu</B>
| <B>Name</B>              <B>|</B> <B>Class</B>             <B>|</B> <B>Type</B>      <B>|</B> <B>Default</B>
| XtNfont           | XtCFont           | FontStruct| XtDefaultFont
| XtNforeground     | XtCForeground     | Pixel     | XtDefaultForeground
| XtNtablist        | XtCTablist        | String    | NULL
| XtNmenu           | XtCMenu           | String    | &quot;empty"
| XtNactive         | XtCActive         | long      | 0xFFFFFFFF
| XtNselection      | XtCSelection      | int       | -1
| XtNcursor         | XtCCursor         | Cursor    | &quot;arrow"
| XtNactivate       | XtCActivate       | Callback | NULL
| XtNchangeSelection| XtCChangeSelection| Callback | NULL
|                   |                    |            |
|___________________<I>|</I>____________________<I>|</I>____________<I>|</I>______________________</I>
<P>
</DD>
</DL>
<I>XtNfont</I><BR>

Currently, the menu items are all in one font.
<P>
<I>XtNforeground</I><BR>

The color of the text is likewise uniform.
<P>
<I>XtNtablist</I><BR>

A tablist can be provided for tabbing to particular
columns within the label. The string consists of num­
bers separated by one or more blanks. Each number is an
offset in pixels from the left edge of the widget.
<P>
<I>XtNmenu</I><BR>

The menu is a string with labels separated by newlines.
Each line is an item, except when the line consists of
nothing but blanks and dashes. The menu will show a
horizontal line there. Each menu item may have a short­
cut letter, indicated by an underline in front of the
letter. Here is an example:
<P>
<I>&quot;_New\n_Save\nSave</I> <B>_As\n----\nE_xit"</B>
<P>
The shortcut letters will be underlined in the menu.
Note that neither resources in a resource database nor
hardcoded resources in a program may contain actual
newlines. In a resource file, the newlines can be given
as <I>\n</I>, in a C program they must be written as <I>\\n</I>. The
resource manager will automatically convert them to
actual newlines just before they are assigned to the
<I>menu</I> resource.
<P>
<I>XtNactive</I><BR>

Item <I>N</I> is active when bit <I>N</I> in <I>active</I> is set, otherwise
it is grayed out. There is only room for 32 items in
this resource, if there are more than 32 items in the
menu (a bad idea anyway!) the rest of the items will
always be active.
<P>
There should probably be more resources to control
placement of the labels, such as margins, interline
spacing, etc. For the moment, we'll keep it simple.
<P>
<I>XtNselection</I><BR>

When an item is selected, either with the mouse or with
the keyboard, the number of the selected item is stored
in <I>selection</I>. This resource can also be set by the
application to indicate which item should be high­
lighted when the menu opens. (When a mouse is used,
this has no effect, of course.) Items are numbered
starting at 0. The value is -1 if no item is selected.
If an inactive item is selected, the value is stored in
<I>selection</I>, but the item is not highlighted.
<P>
<I>XtNcursor</I><BR>

The cursor (when not <I>None</I>) is the mouse cursor that is
displayed when the mouse is over the widget. The value
<I>None</I> causes the parent's cursor to be used.
<P>
<I>XtNactivate</I><BR>

The <I>activate</I> callback is called when the user has com­
pleted a selection. Usually that means that he released
the mouse on an item or pressed Return. When the mouse
is released outside the menu or on an inactive item,
the callback is not called. The number of the item and
the label are passed as the <I>call_data</I> argument (of type
<I>XfwfTextMenuData*</I>). Items are numbered from 0. Inactive
items are numbered as well.
<P>
<I>XtNchangeSelection</I><BR>

When the user moves from one item to another, the
<I>changeSelection</I> callback is called, with the number of
the new selection as <I>call_data</I>. This callback is called
even when the new selection is an inactive (grayed out)
item. It is also called when the mouse leaves the menu,
in which case the first part of the <I>call_data</I> argument
will be -1. The <I>call_data</I> is of type <I>XfwfTextMenuData*</I>.
<P>
____________________________________________________________________________________________
<DL>
<DT><B>|</B> <DD>                                          <B>Shell</B>
| <B>Name</B>                <B>|</B> <B>Class</B>                  <B>|</B> <B>Type</B>                   <B>|</B> <B>Default</B>
| allowShellResize    | XtCAllowShellResize    | Boolean                | False
| createPopupChildProc| XtCCreatePopupChildProc| XTCreatePopupChildProc | NULL
| XtNgeometry         | XtCGeometry            | String                 | NULL
| overrideRedirect    | XtCOverrideRedirect    | Boolean                | False
| popdownCallback     | XtCPopdownCallback     | Callback               | NULL
| popupCallback       | XtCPopupCallback       | Callback               | NULL
| saveUnder           | XtCSaveUnder           | Boolean                | False
| XtNvisual           | XtCVisual              | Visual *               | CopyFromParent
|                     |                         |                         |
|_____________________<I>|</I>_________________________<I>|</I>_________________________<I>|</I>_________________</I>
<P>
</DD>
</DL>
<DL>
<DT>_____________________________________________________________<DD>
</DD>
</DL>
<DL>
<DT><B>|</B> <DD>                         <B>Composite</B>
</DD>
</DL>
<DL>
<DT>| <B>Name</B> <DD>         <B>|</B> <B>Class</B>            <B>|</B> <B>Type</B>        <B>|</B> <B>Default</B>
| XtNchildren | XtCChildren      | WidgetList | NULL
| insertPosition| XtCInsertPosition| XTOrderProc | NULL
| numChildren | XtCNumChildren | Cardinal    | 0
|               |                   |              |
|_______________<I>|</I>___________________<I>|</I>______________<I>|</I>_________</I>
<P>
</DD>
</DL>
______________________________________________________________________
<DL>
<DT><B>|</B> <DD>                                <B>Core</B>
</DD>
</DL>
<DL>
<DT>| <B>Name</B>             <B>|</B> <B>Class</B>               <B>|</B> <B>Type</B>           <B>|</B> <B>Default</B><DD>
</DD>
</DL>
<DL>
<DT>| XtNx <DD>            | XtCX                | Position       | 0
</DD>
</DL>
<DL>
<DT>| XtNy <DD>            | XtCY                | Position       | 0
</DD>
</DL>
<DL>
<DT>| XtNwidth <DD>        | XtCWidth            | Dimension      | 0
</DD>
</DL>
<DL>
<DT>| XtNheight <DD>       | XtCHeight           | Dimension      | 0
</DD>
</DL>
<DL>
<DT>| borderWidth <DD>     | XtCBorderWidth      | Dimension      | 0
</DD>
</DL>
<DL>
<DT>| XtNcolormap <DD>     | XtCColormap         | Colormap       | NULL
</DD>
</DL>
<DL>
<DT>| XtNdepth <DD>        | XtCDepth            | Int            | 0
| destroyCallback | XtCDestroyCallback | XTCallbackList | NULL
| XtNsensitive     | XtCSensitive        | Boolean        | True
</DD>
</DL>
<DL>
<DT>| XtNtm <DD>           | XtCTm               | XTTMRec        | NULL
| ancestorSensitive| XtCAncestorSensitive| Boolean        | False
| accelerators     | XtCAccelerators     | XTTranslations | NULL
</DD>
</DL>
<DL>
<DT>| borderColor <DD>     | XtCBorderColor      | Pixel          | 0
| borderPixmap     | XtCBorderPixmap     | Pixmap         | NULL
</DD>
</DL>
<DL>
<DT>| background <DD>      | XtCBackground       | Pixel          | 0
| backgroundPixmap | XtCBackgroundPixmap | Pixmap         | NULL
| mappedWhenManaged| XtCMappedWhenManaged| Boolean        | True
</DD>
</DL>
<DL>
<DT>| XtNscreen <DD>       | XtCScreen           | Screen *       | NULL
|                  |                      |                 |
|__________________<I>|</I>______________________<I>|</I>_________________<I>|</I>_________</I>
<P>
</DD>
</DL>
<B>Exports</B><BR>

The <I>call_data</I> of the callback functions is set to a struct
with two fields. The first is the number of the item (start­
ing at 0), the second is a pointer to the label. Note that
it is only a pointer; the receiver should make a local copy
if the label is to be edited.
<P>
<B>type</B><BR>

XfwfTextMenuData = struct {<BR>

int n;<BR>

String label;<BR>

}
<P>
<B>Translations</B><BR>

The translations react both to the mouse and to key presses.
A mouse release causes the menu to pop down. If the mouse
was on an active item at the time, the <I>activate</I> callback
will be called. The Enter key also pops down the menu. Mouse
movement is translated to changes in highlights, ditto for
the up and down cursor keys.
<P>
&lt;EnterWindow&gt;: highlight()
<P>
&lt;LeaveWindow&gt;: highlight()
<P>
&lt;BtnUp&gt;: XtMenuPopdown() notify()
<P>
&lt;BtnMotion&gt;: highlight()
<P>
&lt;Key&gt;Return: XtMenuPopdown() notify()
<P>
&lt;Key&gt;Escape: XtMenuPopdown()
<P>
&lt;Key&gt;Up: previous()
<P>
&lt;Key&gt;Down: next()
<P>
&lt;Key&gt;: shortcut()
<P>
&lt;Map&gt;: init() add_keyboard_grab()
<P>
&lt;Unmap&gt;: remove_keyboard_grab()
<P>
<I>add_keyboard_grab</I>
<P>
<I>remove_keyboard_grab</I>
<I>highlight</I>
<P>
The <I>highlight</I> action determines which item is selected
by looking at the coordinates of the mouse. The previ­
ous selection, if any, is drawn in normal colors again
and the new one, if any, is shown in reverse. If the
selection changed, the <I>changeSelection</I> callback is
called.
<P>
<I>notify</I>
<P>
The <I>notify</I> action invokes the <I>activate</I> callback, unless
the current selection is inactive or there is no selec­
tion.
<P>
<I>previous</I>
<P>
The <I>prev</I> action moves the highlight up one item, skip­
ping inactive items. If there are no more items above
the current one, the action does nothing. The <I>changeSe­</I>
<I>lection</I> callback is called when there was a change in
selection.
<P>
<I>next</I> The <I>next</I> action is analogous.
<P>
<I>shortcut</I>
<P>
The <I>shortcut</I> action is normally called on a keypress.
The first argument (if any) is a number in decimal rep­
resentation, indicating for which item this is a short­
cut. If there is nu argument, the keypress is taken
from the event and looked up in the <I>shortcut</I> array. If
the keypress is a valid shortcut, the menu pops down
and the <I>activate</I> callback will be called, unless the
item is not active.
<P>

<HR><P>
<A NAME="toc"><B>Table of Contents</B></A><P>
<UL>
<LI><A NAME="toc0" HREF="#sect0">NAME</A></LI>
<LI><A NAME="toc1" HREF="#sect1">DESCRIPTION</A></LI>
</UL>
</BODY></HTML>
